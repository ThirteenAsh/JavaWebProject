<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.thirteenash.mapper.EmpMapper">
    <!-- resultType 指定结果封装为 com.thirteenash.pojo.Emp，parameterType 使用 map 以支持 name、gender、begin、end 等可选查询条件，MyBatis 根据列名与属性名自动映射 -->
    <select id="list" resultType="com.thirteenash.pojo.Emp" parameterType="map">
    SELECT e.*, d.name as deptName
    FROM emp e
    LEFT JOIN dept d ON e.dept_id = d.id
    WHERE 1=1<!--WHERE 1=1 的作用：1. 永远成立的条件2. 方便后续使用 AND 拼接动态条件3. 避免第一个 AND 出现 SQL 语法错误-->
    <if test="name != null and name != ''">
        AND e.name LIKE concat('%', #{name}, '%')
    </if>
    <if test="gender != null">
        AND e.gender = #{gender}
    </if>
    <if test="begin != null and end != null">
        AND e.entry_date BETWEEN #{begin} AND #{end}
    </if>
    ORDER BY e.update_time DESC
</select>

</mapper>
